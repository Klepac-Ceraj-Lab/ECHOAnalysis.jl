<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dealing with Metadata · ECHO RESONANCE Paper 1</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ECHO RESONANCE Paper 1</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Getting Started</a></li><li class="current"><a class="toctext" href>Dealing with Metadata</a><ul class="internal"><li><a class="toctext" href="#Functions-1">Functions</a></li><li><a class="toctext" href="#Index-1">Index</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Dealing with Metadata</a></li></ul><a class="edit-page" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/master/docs/src/metadata_handling.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Dealing with Metadata</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Subject-and-Sample-Metadata-1" href="#Subject-and-Sample-Metadata-1">Subject and Sample Metadata</a></h1><ul><li><a href="#Subject-and-Sample-Metadata-1">Subject and Sample Metadata</a></li><ul><li><a href="#Functions-1">Functions</a></li><li><a href="#Index-1">Index</a></li></ul></ul><h2><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.breastfeeding-Tuple{DataFrames.DataFrameRow}" href="#ECHOAnalysis.breastfeeding-Tuple{DataFrames.DataFrameRow}"><code>ECHOAnalysis.breastfeeding</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">breastfeeding(row::DataFrameRow)</code></pre><p>Checks a wide-form metadata row for breastfeeding information. Returns <code>true</code> if any of the following are <code>true</code>:</p><ul><li><code>:milkFeedingMethods</code> contains &quot;breast&quot;</li><li><code>:exclusivelyNursed</code> is &quot;Yes&quot; (or &quot;yes&quot;)</li><li>Both <code>:exclusivelyNursed</code> and <code>:exclusiveFormulaFed</code> are &quot;No&quot; (or &quot;no&quot;)</li><li>Any of the following have values &gt; 0:<ul><li><code>:typicalNumberOfFeedsFromBreast</code></li><li><code>:typicalNumberOfEpressedMilkFeeds</code></li><li><code>:lengthExclusivelyNursedMonths</code></li><li><code>:noLongerFeedBreastmilkAge</code></li></ul></li></ul><p>Otherwise returns <code>false</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L99-L114">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.firstkids-Tuple{AbstractArray{#s20,1} where #s20&lt;:NamedTuple}" href="#ECHOAnalysis.firstkids-Tuple{AbstractArray{#s20,1} where #s20&lt;:NamedTuple}"><code>ECHOAnalysis.firstkids</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">firstkids(samples::Vector{&lt;:NamedTuple}; skipethanol=true)
firstkids(samples::Vector{&lt;:AbstractString}; skipethanol=true)</code></pre><p>From a list of sample ids, identify the earliest sample for each child. <code>Samples</code> may be sample IDs that can be parsed by <a href="#ECHOAnalysis.resolve_sampleID-Tuple{Union{AbstractString, Symbol}}"><code>resolve_sampleID</code></a>, or <code>NamedTuple</code>s containing <code>:subject</code> and <code>:timepoint</code> fields.</p><p>If <code>skipethanol</code> is true, sample names containing <code>_#E_</code> will be skipped.</p><p>Returns a vector of indicies that can be used to slice the original vector.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L154-L165">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.formulafeeding-Tuple{DataFrames.DataFrameRow}" href="#ECHOAnalysis.formulafeeding-Tuple{DataFrames.DataFrameRow}"><code>ECHOAnalysis.formulafeeding</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">formulafeeding(row::DataFrameRow)</code></pre><p>Checks a wide-form metadata row for formula feeding information. Returns <code>true</code> if any of the following are <code>true</code>:</p><ul><li><code>:milkFeedingMethods</code> contains &quot;Formula&quot; (or &quot;formula&quot;)</li><li><code>:exclusivelyFormulaFed</code> is &quot;Yes&quot; (or &quot;yes&quot;)</li><li>Both <code>:exclusivelyNursed</code> and <code>:exclusiveFormulaFed</code> are &quot;No&quot; (or &quot;no&quot;)</li><li><code>:amountFormulaPerFeed</code> is &gt; 0:</li><li>Either <code>:amountFormulaPerFeed</code> or <code>:formulaTypicalType</code> have (non-missing) values</li></ul><p>Otherwise returns <code>false</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L128-L140">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.getfocusmetadata-Tuple{AbstractString,Array{#s20,1} where #s20&lt;:NamedTuple}" href="#ECHOAnalysis.getfocusmetadata-Tuple{AbstractString,Array{#s20,1} where #s20&lt;:NamedTuple}"><code>ECHOAnalysis.getfocusmetadata</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">getfocusmetadata(longfilepath, samples; focus=metadata_focus_headers)</code></pre><p>Get a wide-form metadata table with a subset of headers for a subset of subject/sample IDs</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L451-L455">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.getfocusmetadata-Tuple{DataFrames.AbstractDataFrame,Array{#s19,1} where #s19&lt;:NamedTuple}" href="#ECHOAnalysis.getfocusmetadata-Tuple{DataFrames.AbstractDataFrame,Array{#s19,1} where #s19&lt;:NamedTuple}"><code>ECHOAnalysis.getfocusmetadata</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">getfocusmetadata(df, samples; focus=metadata_focus_headers)</code></pre><p>Get a wide-form metadata table with a subset of headers for a subset of subject/sample IDs</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L416-L420">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.getmetadata-Tuple{DataFrames.AbstractDataFrame,Array{Int64,1},Array{Int64,1},Array{#s21,1} where #s21&lt;:AbstractString}" href="#ECHOAnalysis.getmetadata-Tuple{DataFrames.AbstractDataFrame,Array{Int64,1},Array{Int64,1},Array{#s21,1} where #s21&lt;:AbstractString}"><code>ECHOAnalysis.getmetadata</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Get the metadata values for a given set of subjects and timepoints</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L248-L250">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.getmetadatum" href="#ECHOAnalysis.getmetadatum"><code>ECHOAnalysis.getmetadatum</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Get the metadata value for a given subject and timepoint</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L222-L224">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.metacolor-Tuple{AbstractArray{T,1} where T,AbstractArray{T,1} where T}" href="#ECHOAnalysis.metacolor-Tuple{AbstractArray{T,1} where T,AbstractArray{T,1} where T}"><code>ECHOAnalysis.metacolor</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">metacolor(metadata::AbstractVector, colorlevels::AbstractVector; missing_color=colorant&quot;gray&quot;)</code></pre><p>Convert metadata into colors</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L209-L213">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.numberify-Tuple{Any}" href="#ECHOAnalysis.numberify-Tuple{Any}"><code>ECHOAnalysis.numberify</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">numberify(x)
numberify(v::AbstractArray)</code></pre><p>Try to convert something into a number or array of numbers using the heuristics:</p><ul><li>if x is already a number or is <code>missing</code>, return x</li><li>if v is already an array of numbers, return v</li><li>if x is a <code>String</code>:<ul><li>if x contains a <code>.</code> or <code>e</code>, parse as a <code>Float64</code></li><li>Otherwise parse as an Int</li></ul></li><li>if numberified vector contains any <code>Float</code>s, return a vector of <code>missing</code> and <code>Float64</code></li><li>if x is anything other than a String or a number, return <code>missing</code></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L175-L187">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.resolve_letter_timepoint-Tuple{AbstractString}" href="#ECHOAnalysis.resolve_letter_timepoint-Tuple{AbstractString}"><code>ECHOAnalysis.resolve_letter_timepoint</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">resolve_letter_timepoint(sid::AbstractString)
resolve_letter_timepoint(sid::Missing)</code></pre><p>Deals with sampleIDs in which the timepoint is given as a letter. Eg. <code>40b</code> indicates timepoint 2 from subject ID 40. If no letter is provided, timepoint is assumed to be 1.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L29-L36">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.resolve_sampleID-Tuple{Union{AbstractString, Symbol}}" href="#ECHOAnalysis.resolve_sampleID-Tuple{Union{AbstractString, Symbol}}"><code>ECHOAnalysis.resolve_sampleID</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">resolve_sampleID(sid::Union{AbstractString,Symbol})</code></pre><p>Parse a sample name and return its components as a named tuple:</p><p>Example: For the sample <code>C0040_3F_1A</code>:</p><ul><li><code>C0040</code> means &quot;&quot;<strong>C</strong>hild, subject ID <strong>40</strong>&quot;</li><li><code>3F</code> means &quot;timepoint <strong>3</strong>&quot;, <strong>F</strong>ecal (genotech). May also be <code>E</code> for <strong>E</strong>thanol.</li><li>1A means &quot;replicate <strong>1</strong>, aliquot <strong>A</strong>&quot;</li></ul><p>This function returns the <code>NamedTuple</code> <code>(sample=&quot;C0040_3F_1A&quot;, subject=40, timepoint=3)</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L1-L13">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.samplelessthan-Union{Tuple{T}, Tuple{T,T}} where T&lt;:NamedTuple" href="#ECHOAnalysis.samplelessthan-Union{Tuple{T}, Tuple{T,T}} where T&lt;:NamedTuple"><code>ECHOAnalysis.samplelessthan</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">samplelessthan(x::T, y::T) where T &lt;: NamedTuple
samplelessthan(x::T, y::T) where T &lt;: AbstractString</code></pre><p>Function to use for sorting <code>NamedTuple</code>s from sample IDs. String versions of sampleIDs will be parsed with <code>resolve_sampleID</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L55-L61">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ECHOAnalysis.uniquesamples" href="#ECHOAnalysis.uniquesamples"><code>ECHOAnalysis.uniquesamples</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">uniquesamples(samples::AbstractVector{&lt;:NamedTuple}, identifiers::Vector{Symbol}=[:subject,:timepoint];
                    skipethanol=true, samplefilter=x-&gt;true)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Klepac-Ceraj-Lab/echo_analysis/blob/f2a0c127908726dbd987857e3b89f2e2a798385e/src/metadata_handling.jl#L66-L69">source</a></section><h2><a class="nav-anchor" id="Index-1" href="#Index-1">Index</a></h2><ul><li><a href="../file_handling/#ECHOAnalysis.add_batch_info-Tuple{AbstractString}"><code>ECHOAnalysis.add_batch_info</code></a></li><li><a href="#ECHOAnalysis.breastfeeding-Tuple{DataFrames.DataFrameRow}"><code>ECHOAnalysis.breastfeeding</code></a></li><li><a href="#ECHOAnalysis.firstkids-Tuple{AbstractArray{#s20,1} where #s20&lt;:NamedTuple}"><code>ECHOAnalysis.firstkids</code></a></li><li><a href="#ECHOAnalysis.formulafeeding-Tuple{DataFrames.DataFrameRow}"><code>ECHOAnalysis.formulafeeding</code></a></li><li><a href="#ECHOAnalysis.getfocusmetadata-Tuple{DataFrames.AbstractDataFrame,Array{#s19,1} where #s19&lt;:NamedTuple}"><code>ECHOAnalysis.getfocusmetadata</code></a></li><li><a href="#ECHOAnalysis.getfocusmetadata-Tuple{AbstractString,Array{#s20,1} where #s20&lt;:NamedTuple}"><code>ECHOAnalysis.getfocusmetadata</code></a></li><li><a href="#ECHOAnalysis.getmetadata-Tuple{DataFrames.AbstractDataFrame,Array{Int64,1},Array{Int64,1},Array{#s21,1} where #s21&lt;:AbstractString}"><code>ECHOAnalysis.getmetadata</code></a></li><li><a href="#ECHOAnalysis.getmetadatum"><code>ECHOAnalysis.getmetadatum</code></a></li><li><a href="../file_handling/#ECHOAnalysis.merge_tables-Tuple{Any,Any,Any}"><code>ECHOAnalysis.merge_tables</code></a></li><li><a href="#ECHOAnalysis.metacolor-Tuple{AbstractArray{T,1} where T,AbstractArray{T,1} where T}"><code>ECHOAnalysis.metacolor</code></a></li><li><a href="#ECHOAnalysis.numberify-Tuple{Any}"><code>ECHOAnalysis.numberify</code></a></li><li><a href="#ECHOAnalysis.resolve_letter_timepoint-Tuple{AbstractString}"><code>ECHOAnalysis.resolve_letter_timepoint</code></a></li><li><a href="#ECHOAnalysis.resolve_sampleID-Tuple{Union{AbstractString, Symbol}}"><code>ECHOAnalysis.resolve_sampleID</code></a></li><li><a href="#ECHOAnalysis.samplelessthan-Union{Tuple{T}, Tuple{T,T}} where T&lt;:NamedTuple"><code>ECHOAnalysis.samplelessthan</code></a></li><li><a href="#ECHOAnalysis.uniquesamples"><code>ECHOAnalysis.uniquesamples</code></a></li></ul><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Getting Started</span></a></footer></article></body></html>
